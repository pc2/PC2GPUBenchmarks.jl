<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Peer-to-Peer Memcpy · PC2GPUBenchmarks.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><script src="../../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PC2GPUBenchmarks.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">PC2GPUBenchmarks</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../gpuinfo/">CUDA/GPU Information</a></li><li class="is-active"><a class="tocitem" href>Peer-to-Peer Memcpy</a><ul class="internal"><li><a class="tocitem" href="#Unidirectional"><span>Unidirectional</span></a></li><li><a class="tocitem" href="#Bidirectional"><span>Bidirectional</span></a></li></ul></li><li><a class="tocitem" href="../host2device_memcpy/">Host-to-Device Memcpy</a></li><li><a class="tocitem" href="../gpustresstest/">GPU Stress Test</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../explanations/dgx/">DGX Details</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">References</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../refs/gpuinfo/">CUDA/GPU Information</a></li><li><a class="tocitem" href="../../refs/p2p_memcpy/">Peer-to-Peer Memcpy</a></li><li><a class="tocitem" href="../../refs/host2device_memcpy/">Host-to-Device Memcpy</a></li><li><a class="tocitem" href="../../refs/gpustresstest/">GPU Stress Test</a></li><li><a class="tocitem" href="../../refs/monitoring/">Monitoring</a></li><li><a class="tocitem" href="../../refs/cuda_wrappers/">CUDA Wrappers</a></li><li><a class="tocitem" href="../../refs/utility/">Utility</a></li><li><a class="tocitem" href="../../refs/workers/">Worker Utilities</a></li><li><a class="tocitem" href="../../refs/hdf5/">HDF5</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Peer-to-Peer Memcpy</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Peer-to-Peer Memcpy</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://git.uni-paderborn.de/pc2/julia/PC2GPUBenchmarks.jl/blob/master/docs/src/examples/p2p_memcpy.md#" title="Edit source"><span class="docs-icon fa"></span><span class="docs-label is-hidden-touch">Edit source</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Peer-to-Peer-Memcpy"><a class="docs-heading-anchor" href="#Example:-Peer-to-Peer-Memcpy">Example: Peer-to-Peer Memcpy</a><a id="Example:-Peer-to-Peer-Memcpy-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Peer-to-Peer-Memcpy" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><strong>Test system:</strong> DGX with 8x A100 GPUs (+ NVSwitch)</p></div></div><h2 id="Unidirectional"><a class="docs-heading-anchor" href="#Unidirectional">Unidirectional</a><a id="Unidirectional-1"></a><a class="docs-heading-anchor-permalink" href="#Unidirectional" title="Permalink"></a></h2><pre><code class="language-julia hljs">julia&gt; bench_p2p_memcpy();
Memsize: 38.147 MiB

Bandwidth (GiB/s):
 ├ max: 247.32
 ├ min: 173.5
 ├ avg: 229.63
 └ std_dev: 31.67

julia&gt; bench_p2p_memcpy_all()
8×8 Matrix{Union{Nothing, Float64}}:
    nothing  245.706     241.075     244.467     246.434     242.229     245.085     245.033
 239.046        nothing  241.776     243.853     241.626     245.136     244.467     240.379
 246.957     242.633        nothing  242.937     245.291     248.114     239.193     242.684
 244.724     241.375     244.211        nothing  245.861     238.117     245.085     242.28
 241.576     246.329     242.582     245.602        nothing  246.59      240.677     243.343
 247.114     240.18      245.965     244.006     236.616        nothing  242.28      244.673
 243.802     242.028     248.326     239.933     244.365     245.033        nothing  245.498
 245.136     246.904     239.488     243.343     244.057     240.627     243.445        nothing</code></pre><p>Theoretical maximum should be <code>25GB/s * 12 = 300GB/s ≈ 279GiB/s</code>.</p><h3 id="NVIDIA-Nsight-Systems-profile"><a class="docs-heading-anchor" href="#NVIDIA-Nsight-Systems-profile">NVIDIA Nsight Systems profile</a><a id="NVIDIA-Nsight-Systems-profile-1"></a><a class="docs-heading-anchor-permalink" href="#NVIDIA-Nsight-Systems-profile" title="Permalink"></a></h3><p><img src="../p2p_memcpy_dgx_profile.png" alt="p2p_memcpy_dgx_profile"/></p><h3 id="Discussions"><a class="docs-heading-anchor" href="#Discussions">Discussions</a><a id="Discussions-1"></a><a class="docs-heading-anchor-permalink" href="#Discussions" title="Permalink"></a></h3><p>See <a href="https://gist.github.com/carstenbauer/c482cb14e44246c4186193c50a1f9ac7">this GitHub gist</a>.</p><h2 id="Bidirectional"><a class="docs-heading-anchor" href="#Bidirectional">Bidirectional</a><a id="Bidirectional-1"></a><a class="docs-heading-anchor-permalink" href="#Bidirectional" title="Permalink"></a></h2><pre><code class="language-julia hljs">julia&gt; bench_p2p_memcpy_bidirectional();
Memsize: 38.147 MiB

Bandwidth (GiB/s):
 ├ max: 450.36
 ├ min: 448.66
 ├ avg: 449.69
 └ std_dev: 0.49</code></pre><pre><code class="language-julia hljs">julia&gt; bench_p2p_memcpy_bidirectional_all()
8×8 Matrix{Union{Nothing, Float64}}:
    nothing  456.631     453.133     454.946     453.67      453.953     455.06      454.662
 453.67         nothing  454.01      450.329     455.345     453.02      454.691     455.203
 453.981     451.53         nothing  452.344     453.868     454.747     452.232     454.208
 453.557     451.979     449.883        nothing  454.01      455.288     450.189     454.691
 452.429     454.293     445.094     454.151        nothing  453.472     451.474     453.981
 454.89      454.066     453.84      453.84      451.194        nothing  453.274     451.53
 453.925     453.02      454.293     456.459     451.839     451.951        nothing  455.032
 454.208     416.936     454.265     435.947     452.035     437.836     451.895        nothing</code></pre><p>Theoretical maximum should be <code>25GB/s * 12 * 2 = 600GB/s ≈ 559 GiB/s</code> (is this correct?!).</p><h3 id="NVIDIA-Nsight-Systems-profile-2"><a class="docs-heading-anchor" href="#NVIDIA-Nsight-Systems-profile-2">NVIDIA Nsight Systems profile</a><a class="docs-heading-anchor-permalink" href="#NVIDIA-Nsight-Systems-profile-2" title="Permalink"></a></h3><p><img src="../p2p_memcpy_bidirectional_dgx_profile.png" alt="p2p_memcpy_bidirectional_dgx_profile.png"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gpuinfo/">« CUDA/GPU Information</a><a class="docs-footer-nextpage" href="../host2device_memcpy/">Host-to-Device Memcpy »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Thursday 17 February 2022 19:40">Thursday 17 February 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
